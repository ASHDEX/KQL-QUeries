let window=10m;
let explicit =
SecurityEvent
| where EventID == 4648
| project t=TimeGenerated, Account=SubjectUserName, Target=TargetUserName, Computer, IpAddress;
SecurityEvent
| where EventID == 4624 and LogonType in (3,10)
| project TimeGenerated, Account=TargetUserName, Computer, IpAddress
| join kind=inner explicit on Account, IpAddress
| where TimeGenerated between (t .. t + window)
| summarize hosts=dcount(Computer), host_set=make_set(Computer) by Account, Target, bin(TimeGenerated, 30m)
| where hosts > 2
