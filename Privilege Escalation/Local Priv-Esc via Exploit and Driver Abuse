Event
| where EventID == 6  // Driver loaded
| extend ImageLoaded = extract(@"<Data Name='ImageLoaded'>([^<]+)</Data>", 1, EventData),
         Hashes = extract(@"<Data Name='Hashes'>([^<]+)</Data>", 1, EventData),
         Signed = extract(@"<Data Name='Signed'>([^<]+)</Data>", 1, EventData),
         Signature = extract(@"<Data Name='Signature'>([^<]+)</Data>", 1, EventData),
         SignatureStatus = extract(@"<Data Name='SignatureStatus'>([^<]+)</Data>", 1, EventData)
| where Signed =~ "false" or SignatureStatus =~ "Invalid" or 
        ImageLoaded has @"\Users\" or ImageLoaded has @"\Temp\"
| project TimeGenerated, Computer, ImageLoaded, Hashes, Signed, Signature
