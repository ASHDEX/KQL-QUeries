SigninLogs
| where ResultType in ("50126","50053","50055","50056","50057","50059","50074","51004") // failed auth codes
| where AppDisplayName in ("Office 365 Exchange Online","SharePoint Online","OneDrive","Outlook")
| extend Country = tostring(LocationDetails.countryOrRegion)
| summarize FailedUsers=dcount(UserPrincipalName), Attempts=count() 
  by bin(TimeGenerated, 1h), IPAddress, Country
| where FailedUsers > 10 and Attempts > 30
| where Country !in ("YourCountry","TrustedCountry")
| order by TimeGenerated desc
